## vue 2 使用Bus.js实现非父子组件通信
---

vue2中废弃了$dispatch和$broadcast广播和分发事件的方法。父子组件中可以用props和$emit()。如何实现非父子组件间的通信，可以通过实例一个vue实例Bus作为媒介，要相互通信的兄弟组件之中，都引入Bus，然后通过分别调用Bus事件触发和监听来实现通信和参数传递。

### 第一步：借助中央事件总线：在外部新建一个js文件，取名Bus.js,内容为:

    import Vue from 'vue'
    export default new Vue()
        

### 第二步：两个组件作为子组件被同一个父组件所引用，在同一个页面显示。

    import b1 from './b1.vue'
    import b2 from './b2.vue'  
    components:{
        b1,
        b2
    }
    
### 第三步：两个兄弟组件之间的语法

#### 组件1需要定义一个发送数据的方法，此处sendMsg是定义在此的方法，页面点击时候触发此函数，函数主体，通过Bus中央事件总线用$emit发送一个send事件，事件的功能就是传送一个this.a++的数据，区分sendMsg和send，前者是当前页面的点击事件，后者是发送出去，需要其他组件监听的事件。

    <button @click ="sendMsg">向组件传值</button>
    
#### methods

    methods:{
        sendMsg(){
            Bus.$emit('send',this.a++)
        }
    }

#### 组件2在组件2事先定义一个变量，在生命周期为created的时候，通过Bus中央事件总线用$on监听组件1中发送的send事件，用一个带参数的回调函数，接收穿过来的值，参数即为传的值 ，把值赋值给当前组件的变量。

    data(){
        return{
            msg:'初始值'
        }
    }
    created(){
        var self = this
        Bus.$on('send',function(val){
            self.msg = val
        )
    }
    
### 方式2： 可以看做方式1的简化版

#### 第一步：省略了外部的js文件，直接把总线放在main.js里的vue实例中

    new Vue({
        el:'#app',
        router,
        data:{
            Bus:new Vue()
        },
        template:'<App/>',
        components:{ App }
    })

#### 第二步：在使用的时候，不需要引入外部文件，只需要在Bus前加this.$root，即可调用。

    methods:{
        sendMsg(){
            this.$root.Bus.$emit('send',this.a++)
        }
    }
    created(){
        var self = this
        this.$root.Bus.$on('send',function(){
            self.msg=val
        })
    }
